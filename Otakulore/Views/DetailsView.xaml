<Page x:Class="Otakulore.Views.DetailsView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:controls="using:Microsoft.UI.Xaml.Controls"
      xmlns:models="using:Otakulore.Models"
      xmlns:viewModels="using:Otakulore.ViewModels"
      Background="{ThemeResource ResourceKey=ApplicationPageBackgroundThemeBrush}">
    <Page.DataContext>
        <viewModels:DetailsViewModel/>
    </Page.DataContext>
    <controls:TabView x:Name="TabControl" IsAddTabButtonVisible="False" TabWidthMode="SizeToContent" SelectionChanged="TabSwitched">
            <controls:TabView.TabItems>
                <controls:TabViewItem Header="Overview" IsClosable="False">
                    <controls:TabViewItem.IconSource>
                        <controls:FontIconSource Glyph="&#xE10F;"/>
                    </controls:TabViewItem.IconSource>
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="10"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Image Grid.Column="0">
                                <Image.Source>
                                    <BitmapImage UriSource="{Binding Path=ImageUrl}"/>
                                </Image.Source>
                            </Image>
                            <Grid Grid.Column="2">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <ToggleButton x:Name="FavoriteButton" Grid.Row="0" Content="&#xEB51;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Right" Click="UpdateFavorites"/>
                                <StackPanel Grid.Row="2" Spacing="2">
                                    <TextBlock Text="{Binding Path=Title}" FontSize="24" FontWeight="Bold"/>
                                    <StackPanel x:Name="GenreStack" Orientation="Horizontal" Spacing="5"/>
                                </StackPanel>
                            </Grid>
                        </Grid>
                        <Grid Grid.Row="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0" Spacing="5">
                                <StackPanel>
                                    <TextBlock Text="Format" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Path=Format}"/>
                                </StackPanel>
                                <StackPanel>
                                    <TextBlock Text="Status" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Path=Status}"/>
                                </StackPanel>
                                <StackPanel>
                                    <TextBlock Text="Episodes" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Path=Episodes}"/>
                                </StackPanel>
                                <StackPanel>
                                    <TextBlock Text="Starting Date" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Path=StartingDate}"/>
                                </StackPanel>
                                <StackPanel>
                                    <TextBlock Text="Ending Date" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Path=EndingDate}"/>
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Grid.Column="2" Spacing="5">
                                <TextBlock Text="Synopsis" FontWeight="Bold"/>
                                <TextBlock Text="{Binding Path=Synopsis}" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </controls:TabViewItem>
                <controls:TabViewItem Header="Watch" IsClosable="False">
                    <controls:TabViewItem.IconSource>
                        <controls:FontIconSource Glyph="&#xE116;"/>
                    </controls:TabViewItem.IconSource>
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="10"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <AutoSuggestBox x:Name="ContentSearchInput" Grid.Column="0" KeyUp="ContentSearchEntered" SuggestionChosen="ContentProviderSelected">
                                <AutoSuggestBox.ItemTemplate>
                                    <DataTemplate x:DataType="models:TitleItemModel">
                                        <TextBlock Text="{Binding Path=Title}" ToolTipService.ToolTip="{Binding Path=LanguageName}"/>
                                    </DataTemplate>
                                </AutoSuggestBox.ItemTemplate>
                            </AutoSuggestBox>
                            <ComboBox x:Name="ContentProviderSelection" Grid.Column="2" SelectionChanged="UpdateContent">
                                <ComboBoxItem Content="AnimeKisa" Tag="ak"/>
                                <ComboBoxItem Content="Gogoanime" Tag="ggo"/>
                                <ComboBoxItem Content="4Anime" Tag="4a"/>
                            </ComboBox>
                        </Grid>
                        <StackPanel Grid.Row="2">
                            <controls:ProgressRing IsActive="{Binding Path=IsLoading}" HorizontalAlignment="Center" VerticalAlignment="Center" Width="50" Height="50"/>
                            <ListView x:Name="ContentList" IsItemClickEnabled="True" ItemClick="WatchSelectedContent">
                                <ListView.ItemTemplate>
                                    <DataTemplate x:DataType="models:WatchItemModel">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="10"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Image Grid.Column="0">
                                                <Image.Source>
                                                    <BitmapImage UriSource="{Binding Path=ImageUrl}"/>
                                                </Image.Source>
                                            </Image>
                                            <TextBlock Grid.Column="2" Text="{Binding Path=Title}" VerticalAlignment="Center" FontSize="16"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </StackPanel>
                    </Grid>
                </controls:TabViewItem>
            </controls:TabView.TabItems>
        </controls:TabView>
</Page>